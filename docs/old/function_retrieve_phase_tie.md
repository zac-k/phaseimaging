### phaseimaging.retrieve_phase_tie

Retrieves the exit phase from two or three out-of-focus images using the transport-of-intensity equation (TIE).

    phaseimaging.retrieve_phase_tie(defocus, wavelength, image_width, intensity_derivative, image_in=None, image_intensity=1, k_kernel=None, inverse_k_squared_kernel=None, reg_param=0.1, reg_param_tie=None)
                       
                       
|  |  |  |
|---|---|---|
| Parameters: | **defocus** : *float* |   |
|  |  | Microscope defocus in metres. This should be positive; this function assumes that the under-focus image is at negative defocus, and the in-focus defocus is zero.  |
|  | **wavelength** : *float* |  |
|  |  | Wavelength of incident beam in metres. |
|  | **image_width** : *tuple*, *list* |  |
|  |  | Three element tuple or list containing the width of the specimen array in metres, in the x-, y-, and z-direction, respectively. |
|  | **intensity_derivative** : *ndarray* |  |
|  |  | Longitudinal derivative of the intensity at the image plane |
|  | **image_in** : *ndarray*, *optional* |  |
|  |  | In-focus image. If not included, the function will compute the phase from the two out-of-focus images. This requires that `image_intensity` be set to the appropriate value if it is not `1`|
|  | **image_intensity** : *float* |  |
|  |  | The incident intensity; that is, the uniform intensity of the image in the absence of a specimen. Default is unity. Has no effect if an in-focus image is included. |
|  | **k_kernel**:*ndarray*, *optional* |  |
|  |  | Kernel of k-space vectors at z = 0. This can be saved from previous calculations provided that the size and resolution are the same. If this parameter is omitted, it will be generated by this function. |
|  | **inverse_k_squared_kernel**:*ndarray*, *optional* |  |
|  |  | Regularised inverse k^2 array. This can be saved from previous calculations provided that the size and resolution are the same. If this parameter is omitted, it will be generated by this function using the default regularisation parameter. |
|  | **reg_param** : *float*, *optional* |  |
|  |  | Regularisation parameter for the division by the in-focus intensity. Default is `0.1`. Has no effect if only two images are used. |
|  | **reg_param_tie** : *float*, *optional* |  |
|  |  | Regularisation parameter for the division by k^2. Uses the default if not included. Has no effect if `inverse_k_squared_kernel` is provided. |
| Returns: | **phase** : *ndarray* |  |
|  |  | Computed phase. |